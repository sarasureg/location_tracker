<!DOCTYPE html>
<html>
<head>
    <title>Team Location Check-In</title>
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 400px; margin: auto; background-color: #f4f4f9; }
        .container { background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 5px rgba(0,0,0,0.1); }
        h2 { text-align: center; color: #333; }
        input, select, button { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #ddd; border-radius: 4px; box-sizing: border-box; }
        button { background-color: #28a745; color: white; border: none; font-weight: bold; cursor: pointer; }
        button:hover { background-color: #218838; }
        #status { text-align: center; margin-top: 10px; font-size: 0.9em; color: #555; }
    </style>
</head>
<body>

<div class="container">
    <h2>üìç Team Check-In</h2>
    
    <label>Name:</label>
    <select id="name">
        <option value="" disabled selected>Select your name</option>
        <option value="Amit">Amit</option>
        <option value="Priya">Priya</option>
        <option value="Rahul">Rahul</option>
        <option value="Sneha">Sneha</option>
    </select>

    <label>Current Task:</label>
    <input type="text" id="task" placeholder="e.g. Client Visit, Site Audit">

    <button onclick="getLocation()" id="btnSubmit">Check In & Send Location</button>
    <p id="status"></p>
</div>

<script>
    // ----------------------------------------------------
    // PASTE YOUR GOOGLE SCRIPT URL INSIDE THE QUOTES BELOW
    // ----------------------------------------------------
    const SCRIPT_URL = "https://script.google.com/a/macros/brainwareuniversity.ac.in/s/AKfycbxsute8rniNBXKPt3jGbVtRszs_oNY5khnYaTvUabcKRrcmxHiuR7w5yt8Vy88Jc7DV/exec"; 

    function getLocation() {
        var status = document.getElementById("status");
        var btn = document.getElementById("btnSubmit");
        var name = document.getElementById("name").value;
        var task = document.getElementById("task").value;

        if(!name || !task) {
            status.innerHTML = "‚ö†Ô∏è Please select Name and Task.";
            status.style.color = "red";
            return;
        }

        status.innerHTML = "‚è≥ Getting GPS location...";
        status.style.color = "blue";
        btn.disabled = true;

        if (navigator.geolocation) {
            navigator.geolocation.getCurrentPosition(
                (position) => {
                    sendData(name, task, position.coords.latitude, position.coords.longitude);
                },
                (error) => {
                    status.innerHTML = "‚ùå Error: Could not get location. Allow GPS access.";
                    status.style.color = "red";
                    btn.disabled = false;
                },
                { enableHighAccuracy: true } // Request best possible GPS
            );
        } else {
            status.innerHTML = "‚ùå Geolocation is not supported by this browser.";
        }
    }

    function sendData(name, task, lat, long) {
        var status = document.getElementById("status");
        status.innerHTML = "üöÄ Sending data to Sheet...";

        var data = JSON.stringify({ name: name, task: task, lat: lat, long: long });

        fetch(SCRIPT_URL, {
            method: "POST",
            mode: "no-cors", // Important for Google Script
            headers: { "Content-Type": "application/json" },
            body: data
        }).then(() => {
            status.innerHTML = "‚úÖ Check-in Successful! Data saved.";
            status.style.color = "green";
            document.getElementById("task").value = ""; // Clear task
            document.getElementById("btnSubmit").disabled = false;
        }).catch(error => {
            console.error('Error:', error);
            status.innerHTML = "‚ùå Failed to connect to server.";
            status.style.color = "red";
        });
    }
</script>

</body>
</html>
